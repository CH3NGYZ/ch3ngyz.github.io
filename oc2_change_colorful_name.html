<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>厨房名字改颜色与大小工具</title>
    <style>
      body {
        font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        background: linear-gradient(135deg, #f9fafb, #eef2f3);
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        color: #333;
      }

      .container {
        width: 85%;
        max-width: 1000px;
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        margin-top: 40px;
        padding: 30px 40px;
      }

      h1 {
        text-align: center;
        font-size: 40px;
        color: #1b6ac9;
        margin-bottom: 10px;
      }

      .subtitle {
        text-align: center;
        color: #777;
        font-size: 18px;
        margin-bottom: 30px;
      }

      label {
        display: block;
        margin: 10px 0;
      }

      textarea {
        width: 100%;
        border: 1px solid #ccc;
        border-radius: 15px;
        font-size: 30px;
        padding: 15px;
        resize: none;
        transition: all 0.3s;
      }

      textarea:focus {
        outline: none;
        border-color: #1b6ac9;
        box-shadow: 0 0 8px rgba(27, 106, 201, 0.4);
      }

      .popup {
        margin-top: 25px;
        padding: 20px;
        border-radius: 15px;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 10px;
      }

      .popup label {
        font-weight: 600;
        color: #444;
      }

      #colorPicker,
      #fontSize {
        margin-left: 10px;
      }

      #styledText {
        margin-top: 25px;
        min-height: 80px;
        padding: 15px;
        border: 1px dashed #ccc;
        border-radius: 15px;
        font-size: 35px;
        background: #fafafa;
      }

      #styledTextSource {
        margin-top: 15px;
        border-radius: 10px;
        font-size: 16px;
        padding: 10px;
        resize: none;
        height: 100px;
        background: #fdfdfd;
      }

      button {
        display: inline-block;
        margin-top: 15px;
        background: linear-gradient(135deg, #1b6ac9, #3888ff);
        border: none;
        color: #fff;
        padding: 12px 28px;
        border-radius: 12px;
        font-size: 18px;
        cursor: pointer;
        transition: all 0.2s;
      }

      button:hover {
        background: linear-gradient(135deg, #1760b3, #2e7aff);
        transform: translateY(-1px);
        box-shadow: 0 4px 10px rgba(27, 106, 201, 0.3);
      }

      .footer {
        text-align: center;
        font-size: 14px;
        color: #666;
        margin-top: 40px;
      }

      .counter {
        text-align: center;
        margin-top: 20px;
        color: #444;
      }

      a {
        color: #1b6ac9;
        text-decoration: none;
        font-weight: 600;
      }

      a:hover {
        text-decoration: underline;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>厨房名字改颜色与大小工具</h1>
      <div class="subtitle">
        制作者:
        <a href="https://space.bilibili.com/298411931" target="_blank"
          >Bilibili：Azhe是阿哲</a
        >
      </div>

      <label>使用方法：</label>
        <p style="color: #444; line-height: 1.8">
        在下方输入你的名字 → 选中想要修改的文字 → 在下面调整颜色与字号 → 点击“立即复制”，粘贴到MOD菜单里即可。<br><br>
        <b style="color: #1b6ac9">注意事项：</b><br>
        ・每次修改输入框内容后，所有样式都会重置。<br>
        ・如果在选中文字时拖拽过多，也可能导致样式重置。<br>
        ・修改完样式后，请点击输入框外任意位置取消选中，再进行下一次操作。<br>
        ・重复以上步骤即可对不同字符应用不同样式。<br>
        ・粘贴到MOD菜单时，请注意打开修改名字开关！
        </p>


      <textarea
        id="textInput"
        placeholder="在这里输入待修改的名字..."
      ></textarea>

      <div class="popup">
        <label for="colorPicker">颜色：</label>
        <input type="color" id="colorPicker" value="#000000" />

        <label for="fontSize">字号：</label>
        <input type="range" id="fontSize" min="2" max="70" value="35" />
        <span id="fontSizeValue">35</span> px
      </div>

      <div id="styledText">这里显示预览...</div>
      <textarea
        id="styledTextSource"
        placeholder="样式化文本源码（点击下方复制）"
      ></textarea>
      <button onclick="copyToClipboard()">立即复制</button>

      <div class="footer">本工具仅支持电脑端使用，手机暂不兼容。</div>
      <div class="counter">
        <a href="https://hits.sh/ch3ngyz.github.io/oc2_change_colorful_name.html/"><img alt="Hits" src="https://hits.sh/ch3ngyz.github.io/oc2_change_colorful_name.html.svg?style=for-the-badge&label=%E6%9C%AC%E7%BD%91%E7%AB%99%E8%AE%BF%E9%97%AE%E6%80%BB%E6%95%B0"/></a>
      </div>
    </div>

    <script>
      window.addEventListener('DOMContentLoaded', updateFontValue)
      window.addEventListener('resize', updateFontValue)

      var defaultColor = '#000000'
      var defaultFontSize = '35px'

      function applyStyle() {
        var textInput = document.getElementById('textInput')
        var start = textInput.selectionStart
        var end = textInput.selectionEnd
        var color = document.getElementById('colorPicker').value
        var fontSize = document.getElementById('fontSize').value
        var styledText = document.getElementById('styledText').childNodes
        for (var i = start; i < end; i++) {
          if (styledText[i]) {
            styledText[i].style.color = color
            styledText[i].style.fontSize = fontSize + 'px'
          }
        }
      }

      function updateStyledText() {
        var textInput = document.getElementById('textInput').value
        var container = document.getElementById('styledText')
        container.innerHTML = ''
        for (var i = 0; i < textInput.length; i++) {
          var span = document.createElement('span')
          span.textContent = textInput[i]
          span.style.color = defaultColor
          span.style.fontSize = defaultFontSize
          container.appendChild(span)
        }
        applyStyle()
        updateStyledTextSource()
      }

      document
        .getElementById('textInput')
        .addEventListener('input', updateStyledText)
      document.getElementById('colorPicker').addEventListener('input', () => {
        applyStyle()
        updateStyledTextSource()
      })
      document.getElementById('fontSize').addEventListener('input', e => {
        document.getElementById('fontSizeValue').textContent = e.target.value
        applyStyle()
        updateStyledTextSource()
      })

      function updateStyledTextSource() {
        var styledTextSource = document.getElementById('styledTextSource')
        var styledTextDiv = document.getElementById('styledText')
        var styledText = styledTextDiv.childNodes
        var html = ''
        var currentFontSize = defaultFontSize
        var currentColor = defaultColor
        var buffer = ''

        styledText.forEach((node, i) => {
          var color = rgbToHex(node.style.color || defaultColor)
          var size = node.style.fontSize || defaultFontSize
          size = size.replace('px', '')

          if (color === currentColor && size === currentFontSize) {
            buffer += node.textContent
          } else {
            if (buffer) {
              html += `<size=${currentFontSize}><color=${currentColor}>${buffer}</color></size>`
              buffer = ''
            }
            currentFontSize = size
            currentColor = color
            buffer += node.textContent
          }

          if (i === styledText.length - 1) {
            html += `<size=${currentFontSize}><color=${currentColor}>${buffer}</color></size>`
          }
        })

        html = html.replace(/<size=35>(.*?)<\/size>/g, '$1')
        html = html.replace(/<color=#000000>(.*?)<\/color>/g, '$1')
        styledTextSource.value = html
      }

      function rgbToHex(rgb) {
        if (/^#[0-9A-F]{6}$/i.test(rgb)) return rgb
        var res = /rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(rgb)
        if (!res) return '#000000'
        return (
          '#' +
          res
            .slice(1)
            .map(x => ('0' + parseInt(x).toString(16)).slice(-2))
            .join('')
        )
      }

      function copyToClipboard() {
        var text = document.getElementById('styledTextSource')
        text.select()
        document.execCommand('copy')
        alert('✅ 已复制到剪贴板！')
      }

      function updateFontValue() {
        document.getElementById('fontSizeValue').textContent =
          document.getElementById('fontSize').value
      }
    </script>
  </body>
</html>
